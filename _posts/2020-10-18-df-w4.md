---
layout: post
title: "DF Week4 - Computational Linear Algebra I"
date: 2020-10-18
excerpt: "data fundamentalsç¬”è®°"
tags: [å­¦ä¹ ç¬”è®°, data fundamentals, 2020, python]
feature: https://miro.medium.com/max/1400/1*gHamsYEMBoVIWbTbn3CQ-A.gif
comments: true
---

[reference: week_4_Computational Linear Algebra I.html
](https://moodle.gla.ac.uk/pluginfile.php/1241379/mod_folder/content/0/week_4_matrices_i.pdf?forcedownload=1)

infomation is filteredï¼Œï¼Œå·²ç­›é€‰éƒ¨åˆ†ç”¨å¾—ä¸Šçš„

* ç›®å½•
{:toc}

## Outline

you should know

* **vector & vector space**
  * standard operations on vectors: add & multiplication
* **norm èŒƒå¼**
  * how it can be used to measure vectors å¦‚ä½•ä½¿ç”¨normæµ‹é‡vector
* **inner product å‘é‡å†…ç§¯**
  * å‘é‡å†…ç§¯å¦‚ä½•äº§ç”Ÿå‘é‡çš„å‡ ä½•å½¢
* **mathematical vectors** map onto **numerical arrays** æ•°å­¦çŸ¢é‡å¦‚ä½•æ˜ å°„åˆ°æ•°å­—æ•°ç»„ä¸Š
* ä¸åŒçš„**pè§„èŒƒ(p-norm**)åŠå…¶ç”¨æ³•
* å‘é‡è¡¨ç¤ºçš„é‡è¦è®¡ç®—ç”¨é€”
* how to **characterise vector data with a mean vector and a covariance matrix** å¦‚ä½•ç”¨å¹³å‡çŸ¢é‡å’Œåæ–¹å·®çŸ©é˜µè¡¨ç¤ºçŸ¢é‡æ•°æ®
* properties of high-dimensional vector spaces **é«˜ç»´å‘é‡ç©ºé—´çš„æ€§è´¨**
* basic notation for matrices çŸ©é˜µçš„åŸºæœ¬ç¬¦å·
* view of matrices as linear maps çŸ©é˜µè§†å›¾ - çº¿æ€§æ˜ å°„
* how basic geometric transforms are implemented using matrices ä½¿ç”¨**çŸ©é˜µå®ç°åŸºæœ¬çš„å‡ ä½•å˜æ¢**
* how matrix multiplication is defined and its algebraic properties å®šä¹‰**çŸ©é˜µä¹˜æ³•åŠå…¶ä»£æ•°æ€§è´¨**
* the basic anatomy of matrices **çŸ©é˜µçš„åŸºæœ¬ç»„æˆ**

## Example: Text

string-å¼±ç»“æ„ï¼Œæ— æ³•è´¡çŒ®äºæœºå™¨ç¿»è¯‘ç³»ç»Ÿ

* å¯ä»¥ç»™æ–‡æœ¬ç‰‡æ®µ**æ·»åŠ é¢å¤–æ•°å­¦ç»“æ„**
  * **å°†æ–‡æœ¬ç‰‡æ®µæ”¾ç½®åœ¨å‘é‡ç©ºé—´(vector space)ä¸­**
  * **ç‰‡æ®µå¯ä»¥æ˜¯å•è¯ã€éƒ¨åˆ†è¯æˆ–æ•´ä¸ªå¥å­ã€‚è¿™å°±æ˜¯æ‰€è°“çš„åµŒå…¥**ç®—æ³•Word2vecå¯ä»¥å­¦ä¹ ä»å­—ç¬¦ä¸²åˆ°é«˜ç»´å‘é‡(é€šå¸¸å¤§äº100D)çš„è½¬æ¢ï¼Œåªéœ€è§‚å¯Ÿå¤§é‡çš„æ–‡æœ¬
* **è™½ç„¶å‘é‡ç©ºé—´æ¯ä¸ªç»´åº¦æ²¡æœ‰ç‰¹å®šæ„ä¹‰ï¼Œä½†æ˜¯åµŒå…¥embeddingæ„å‘³ç€è¯­ä¹‰semanticsæ˜ å°„åˆ°ç©ºé—´å…³ç³»ä¸Š**

## Vector spaces

æœ¬è¯¾è€ƒè™‘å‘é‡æ˜¯å®æ•°æœ‰åºå…ƒç»„

* `[ x1ï¼Œx2ï¼Œ... xn ] ï¼Œxi âˆˆ r`
* å‘é‡å›ºå®šç»´åº¦`n`
  * **å…ƒç»„é•¿åº¦ length of the tuple**
* å¯ä»¥å‡è®¾å‘é‡ä¸­**æ¯ä¸ªå…ƒç´ **éƒ½ä¸º**ä¸å…¶ä»–å…ƒç´ æ­£äº¤æ–¹å‘ä¸Šçš„è·ç¦» a distance in an direction orthogonal**

ğŸŠ ä¾‹å­ - æœ‰éœ€è¦è®°çš„æ¦‚å¿µ

* **é•¿åº¦ä¸º3çš„å‘é‡ï¼ˆ3ç»´å‘é‡ï¼‰**ï¼Œå¯ä»¥ç”¨äºè¡¨ç¤ºç¬›å¡å°”åæ ‡ç³»ä¸­çš„ç©ºé—´ä½ç½®
  * æ¯ä¸ªå‘é‡æœ‰3ä¸ªæ­£äº¤çš„æµ‹é‡é‡ 3 **orthogonal measurements** for each vector
  * orthogonal - independent **æ­£äº¤å³ç‹¬ç«‹ï¼Œå³ï¼Œ=90Â°**
* 3D vector`[5,7,3]`
  * `â„^3`
  * ç»„æˆ `5*[1,0,0] + 7*[0,1,0] + 3*[0,0,1]`
  * å¯çœ‹ä¸º**æ­£äº¤å•ä½å‘é‡çš„åŠ æƒå’Œ weighted sum of orthogonal unit vectors**
  * è¯¥å‘é‡ç©ºé—´æœ‰3ä¸ªç‹¬ç«‹basis vectors, å› æ­¤ä¸ºä¸‰ç»´ï¼ˆå‘é‡é•¿åº¦ä¹Ÿä¸º3ï¼‰
* `[1,0,0], [0,1,0], [0,0,1]`
  * **unit vector (basis vectors)**
  * æ¯ä¸ªå‘é‡ï¼Œé•¿åº¦ä¸º`1`
  * éƒ½æŒ‡å‘ä¸€ä¸ªå•ç‹¬çš„æ–¹å‘(æ­£äº¤æ–¹å‘) orthogonal direction

ğŸŠ å‘é‡è¡¨ç¤º

![](/static/2020-10-28-01-02-12.png)

* ç”¨**å°å†™åŠ ç²—å­—æ¯**è¡¨ç¤ºå‘é‡

## Points in Space

### Notation

æ ‡è®°`â„^ğ‘›`

![](/static/2020-10-28-01-05-43.png)

* `â„`å®æ•°é›†
* `â„â‰¥0`éè´Ÿå®æ•°é›†åˆ
* `â„^n`N ä¸ªå®æ•°çš„å…ƒç»„çš„é›†åˆ the set of tuples of exactly `n` real numbers
* `â„^n*m` nè¡Œmä¸ªå…ƒç´ çš„2ç»´å®æ•°çŸ©é˜µé›†åˆ
* `(â„^ğ‘›,â„^ğ‘›)â†’â„` mapï¼šä¸€å¯¹nç»´å‘é‡-å®æ•°çš„æ˜ å°„å¯¹
  * a map from a pair of n-dimensional vectors to a real number

## Vector spaces

![](/static/2020-10-28-01-16-47.png)

* ä»»ä½•**è§„å®šäº†ç»´æ•°`n`çš„å‘é‡éƒ½ä½äºã€å‘é‡ç©ºé—´ `â„^ğ‘›`ã€‘**
  * ç›®å‰å‘é‡ç©ºé—´åªè€ƒè™‘æœ‰é™ç»´åº¦çš„å®æ•°å‘é‡ç©ºé—´ï¼ˆæ ‡å‡†å•ä½åŸºæœ¬å‘é‡ï¼‰ã€è¿˜æœ‰å¤æ•°ï¼Œæ— é™ç»´åº¦ç©ºé—´ã€‘
  * **è¯¥å‘é‡å±äºï¼Œä»»ä½•é•¿åº¦ä¸º`n`çš„ï¼Œå…ƒç´ ä¸ºå®æ•°çš„å‘é‡é›†åˆä¸­**

ğŸŠ ä¸”åœ¨è¯¥å‘é‡ç©ºé—´`â„^ğ‘›`ä¸‹ï¼Œè§„å®šäº†å¦‚ä¸‹æ“ä½œ

* **æ ‡é‡ä¹˜æ³•/æ ‡é‡ç§¯ `ax`** scalar multiplication
  * å¯¹äºä»»ä½•æ ‡é‡`a`ï¼Œéƒ½å®šä¹‰äº†`ax`ï¼ˆæ ‡é‡ç§¯ï¼Ÿï¼‰
  * å¯¹äºå®æ•°å‘é‡ï¼Œ`ax=[ax1,ax2,...,axn]`å…ƒç´ ç¼©æ”¾ elementwise scaling
  * ![](/static/2020-10-28-01-29-19.png)
* **å‘é‡åŠ æ³• `x+y`** vector addition
  * `x+y`ä¸ªå‘é‡ï¼Œ `x`& `y`ç»´æ•°ç›¸åŒ
  * **å®æ•°å‘é‡**ï¼Œ`ğ±+ğ²=[ğ‘¥1+ğ‘¦1,ğ‘¥2+ğ‘¦2,â€¦ğ‘¥ğ‘‘+ğ‘¦ğ‘‘]`å…ƒç´ å’Œ
  * ![](/static/2020-10-28-01-32-07.png)
* **norm `||ğ±||` èŒƒå¼**
  * æµ‹é‡å‘é‡é•¿åº¦
  * `â„ğ‘›â†’â„â‰¥0`
  * ![](/static/2020-10-28-02-32-52.png)
* **å‘é‡å†…ç§¯ `âŸ¨ğ±|ğ²âŸ©  or ğ±âˆ™ğ²`** inner product
  * **å¯ä»¥æ¯”è¾ƒ2ä¸ªå‘é‡å¤¹è§’ angle**
  * <font color="red">2ä¸ªæ­£äº¤å‘é‡çš„å‘é‡å†…ç§¯ä¸º`0`ï¼Œangle=90</font>
  * **å®æ•°å‘é‡çš„å‘é‡å†…ç§¯ï¼Œå³dot productç‚¹ç§¯** `ğ±âˆ™ğ²=ğ‘¥1ğ‘¦1+ğ‘¥2ğ‘¦2+ğ‘¥3ğ‘¦3â€¦ğ‘¥ğ‘‘ğ‘¦ğ‘‘`
  * ![](/static/2020-10-28-02-33-09.png)

ğŸ¬ å‘é‡é—´æ‰€æœ‰æ“ä½œéƒ½åœ¨åŒä¸€å‘é‡ç©ºé—´ä¸­å®šä¹‰

* ä¸åŒç»´åº¦çš„å‘é‡ï¼Œä¸å±äºåŒä¸€å‘é‡ç©ºé—´ï¼Œä¸èƒ½è¿›è¡Œå¦‚ä¸Šå®šä¹‰çš„æ“ä½œ

### topological & inner product spaces

æ‹“æ‰‘&å†…ç§¯ç©ºé—´

![](/static/2020-10-28-02-41-33.png)

* æœ‰äº†èŒƒå¼normï¼Œ å‘é‡ç©ºé—´å°±æ˜¯**æ‹“æ‰‘å‘é‡ç©ºé—´**ï¼Œæ„å‘³ç€
  * å‘é‡ç©ºé—´æ˜¯è¿ç»­çš„ï¼Œä¸”å‘é‡â€œç´§é åœ¨ä¸€èµ·â€ï¼ˆæˆ–å‘é‡å‘¨å›´æœ‰é¢†åŸŸneighbourhoodï¼‰
  * å¯¹äºå‘é‡å†…ç§¯ï¼Œ**å‘é‡ç©ºé—´å³å†…ç§¯ç©ºé—´ï¼ˆå†…ç§¯é›†åˆï¼Ÿï¼‰inner product space**

ğŸŠ ç©ºé—´ä¸­çš„å‘é‡ç‚¹vector pointsã€ç®­å¤´æŒ‡å‘ï¼Œæ˜¯ä»åŸç‚¹è¿˜æ˜¯æ•°å­—å…ƒç»„ï¼Ÿ

![](/static/2020-10-28-02-47-06.png)

* æ•°å­—å…ƒç»„ï¼Ÿ**æˆ–æƒ³è±¡è¿™äº›å‘é‡ç‚¹åœ¨å‘é‡ç©ºé—´ä¸­**
* å‘é‡è¡¨ç¤ºæ•°æ®ï¼Œæ•°æ®åœ¨å‘é‡ç©ºé—´ä¸­
  * vectors to represent data; data lies in space
* çŸ©é˜µç”±å¯¹æ•°æ®çš„æ“ä½œå¾—æ¥ï¼ŒçŸ©é˜µæ‰­æ›²å‘é‡ç©ºé—´
  * matrices to represent operations on data; matrices warp space

### Relation to arrays

ä¸çŸ©é˜µå…³ç³»

* å®æ•°å‘é‡å¯ä»¥ç”¨ä¸€ç»´æµ®ç‚¹æ•°ç»„æ¥è¡¨ç¤ºï¼Œåœ¨æœ¬ç³»åˆ—çš„ç¬¬ä¸€è®²ä¸­ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºâ€œå‘é‡â€
* ä½†æ˜¯è¦å°å¿ƒï¼Œ**è¡¨ç¤ºå’Œæ•°å­¦å…ƒç´ æ˜¯ä¸åŒçš„ä¸œè¥¿**ï¼Œå°±åƒæµ®ç‚¹æ•°ä¸æ˜¯å®æ•°ä¸€æ ·

![](/static/2020-10-28-03-04-57.png)
![](/static/2020-10-28-03-05-55.png)

æ ‡é‡ç§¯
![](/static/2020-10-28-03-06-21.png)
![](/static/2020-10-28-03-06-27.png)

![](/static/2020-10-28-03-08-18.png)
![](/static/2020-10-28-03-08-52.png)

* å‘é‡ç›¸åŠ 
  * `x+y`
* èŒƒå¼
  * `np.linalg.norm(x)`
* ç‚¹ç§¯ï¼Œå‘é‡å†…ç§¯
  * `np.dot(x,y)`

### uses of vectors

å‘é‡ä½¿ç”¨

* **composed**
  * addition
* **compared**
  * norms/inner products
* **weighted**
  * scaling

ğŸ¬ å‘é‡å¯ä»¥å¯¹æ•°æ®è¿›è¡Œå„ç§å˜æ¢

* å› æ­¤vector->ndarrayæ˜ å°„ï¼Œå¯ä»¥æ›´é«˜æ•ˆç®€æ´æ“ä½œ

### Vector Data

æ•°æ®é›†datasetï¼Œé€šå¸¸ä»¥**2Dè¡¨æ ¼**å­˜å‚¨

![](/static/2020-10-28-20-11-28.png)

* å¯ä»¥çœ‹ä¸ºå‘é‡åˆ—è¡¨ lists of vectors
* æ¯è¡Œ - ä»£è¡¨â€œobservationâ€çš„vector
  * æ¯æ¡è§‚å¯Ÿè®°å½•stacked upç»„æˆ2DçŸ©é˜µ
* æ¯åˆ— - è·¨å¤šæ¡è§‚å¯Ÿå€¼çš„ä¸€ç§å…ƒç´ 

ğŸŠ

* ä»¥ä¸Šä¾‹å­ï¼Œæ¯è¡Œå¯çœ‹ä¸ºä¸€ä¸ªåœ¨å‘é‡ç©ºé—´`â„^4`ä¸­çš„å‘é‡
* ä»¥ä¸Šæ•´ä¸ªçŸ©é˜µæ˜¯åŒä¸€ä¸ªå‘é‡ç©ºé—´ä¸­çš„**å‘é‡åºåˆ—**ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥å¯¹è¡¨æ ¼æ•°æ®è¿›è¡Œ**å‡ ä½•æè¿° geometric**

### Geometric Operations

çŸ¢é‡æœ€æ˜æ˜¾ç”¨é€”

* è¡¨ç¤ºäºŒç»´/ä¸‰ç»´å‡ ä½•æ•°æ®
* æ¸¸æˆor3Dæ¸²æŸ“å¼•æ“ä¸­æ‰€æœ‰è®¡ç®—éƒ½ç”±å¤§è§„æ¨¡é‡å¤**ä½ç»´å‘é‡æ“ä½œï¼ˆ2D,3D,4Dï¼‰**ç»„æˆ

![](/static/2020-10-28-20-35-25.png)

å›¾å½¢åŒ–ç®¡é“å°†æ‰€æœ‰ä¸œè¥¿(ç©ºé—´ä½ç½®ã€è¡¨é¢æ³•çº¿æ–¹å‘ã€çº¹ç†åæ ‡ã€é¢œè‰²ç­‰)éƒ½å¤„ç†ä¸ºå¤§é‡çš„çŸ¢é‡æ•°ç»„Graphical pipelines process everything (spatial position, surface normal direction, texture coordinates, colours, and so on) as large arrays of vectors

* åœ¨ GPU ä¸Šè¿›è¡Œå›¾å½¢ç¼–ç¨‹ä¸»è¦æ¶‰åŠå°†**æ•°æ®æ‰“åŒ…åˆ°ä½ç»´å‘é‡æ•°ç»„**(åœ¨ CPU ä¸Š) ï¼Œç„¶åä½¿ç”¨**ç€è‰²å™¨è¯­è¨€åœ¨ GPU ä¸Šå¿«é€Ÿå¤„ç†å®ƒä»¬** Programming for graphics on GPUs largely involves packing data into a low-dimensional vector arrays (on the CPU) then processing them quickly on the GPU using a **shader language**

### Machine Learning Applications

æœºå™¨å­¦ä¹ å¾ˆå¤§ç¨‹åº¦ä¸Šä¾èµ–å‘é‡è¡¨ç¤º

![](/static/2020-10-28-21-24-33.png)

* å°†ä¸€äº›æ•°æ®è½¬æ¢æˆ**ç‰¹å¾å‘é‡feature vectors**
  * ç‰¹å¾å‘é‡ï¼šå‘é‡ç©ºé—´ä¸­æ•°æ®ç¼–ç ï¼ˆå¦‚è¡¨æ ¼æ•°æ®ï¼‰
  * describe some data point that might be a vector representing a word image
* åˆ›å»ºä¸€ä¸ªå‡½æ•°ï¼Œå°†**ç‰¹å¾å‘é‡è½¬æ¢**ä¸ºé¢„æµ‹prediction(ä¾‹å¦‚ç±»æ ‡ç­¾)
  * ç‰¹å¾è½¬æ¢ï¼šå¤„ç†raw data, è¾“å‡ºç‰¹å¾å‘é‡

ğŸŠ æœ€ç®€å•æœ‰æ•ˆçš„æœºå™¨å­¦ä¹ ç®—æ³•ä¹‹ä¸€

> kè¿‘é‚»ç®—æ³•ï¼šç»™å®šä¸€ä¸ªè®­ç»ƒé›†ï¼Œæ–°è¾“å…¥å®ä¾‹ã€‚**åœ¨è®­ç»ƒé›†ä¸­æ‰¾åˆ°ä¸è¯¥å®ä¾‹æœ€é‚»è¿‘çš„kä¸ªå®ä¾‹**ã€‚
>
> è¿™**kä¸ªå®ä¾‹å¤šæ•°å±äºæŸä¸ªç±»**ï¼Œå°±æŠŠè¯¥æ–°è¾“å…¥å®ä¾‹åˆ†ç±»åˆ°è¿™ä¸ªç±»ä¸­

* **k nearest neighbours**kè¿‘é‚»ç®—æ³•
  * æ¶‰åŠdataè®­ç»ƒé›†ï¼ŒåŒ…å«`xi,yi`å¯¹
    * ç‰¹å¾å‘é‡`xi`ï¼Œæ ‡ç­¾`yi`
* å½“ä¸€ä¸ªæ–°ç‰¹å¾éœ€è¦åˆ†ç±»è¿›è¡Œé¢„æµ‹æ—¶ï¼Œ**è®¡ç®—è¯¥è®­ç»ƒé›†ä¸­çš„ k ä¸ªæœ€è¿‘çš„å‘é‡ï¼Œä½¿ç”¨èŒƒæ•°è®¡ç®—è·ç¦»**
  * è¾“å‡ºé¢„æµ‹ï¼ˆæŠŠæ–°è¾“å…¥å½’åˆ°å¤šæ•°ç±»ä¸­ï¼‰æ˜¯è¿™äº› k è¿‘é‚»å®ä¾‹ä¸­**å‡ºç°æ¬¡æ•°æœ€å¤šçš„ç±»æ ‡ç­¾**(k åœ¨æŸç§ç¨‹åº¦ä¸Šæ˜¯é¢„è®¾å€¼; å¯¹äºè®¸å¤šé—®é¢˜ï¼Œå®ƒå¯èƒ½åœ¨3-12å·¦å³)

### Image Compression

![](/static/2020-10-28-22-52-07.png)
![](/static/2020-10-28-22-54-56.png)

* 8x8 image patch could be unraveled to a 64-d vector
  * these vectors could be treated as elements of a vetor space

